<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Shopcart - Account parameters</title>
        <link rel="stylesheet" href="/assets/css/mainaccount.css">
        <link rel="stylesheet" href="/assets/css/header.css">
        <link rel="stylesheet" href="/assets/css/footer.css">
        <!-- Utilisation de Font Awesome pour les ic√¥nes -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <style>
          @import url('https://fonts.googleapis.com/css2?family=Inria+Serif&display=swap');
        </style>
    </head>
<body>

    <header>
        <!-- Checkbox cach√©e pour contr√¥ler le menu mobile -->
    <input type="checkbox" id="menu-toggle">

    <nav class="navbar">
      <div class="logo">
        <div class="logo-img">
          <img src="/assets/images/shopcart-logo.png" alt="Shopcart Logo" class="logo-img">

        </div>
        <span class="logo-text">Shopcart</span>
      </div>

      <!-- Hamburger icon comme label pour la checkbox -->
      <label for="menu-toggle" class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </label>

      <ul class="nav-links">
        <li class="categories-dropdown">
          <!-- Checkbox pour le sous-menu des cat√©gories -->
          <input type="checkbox" id="categories-toggle">
          <label for="categories-toggle">
            Cat√©gories <span class="dropdown-arrow">‚ñº</span>
          </label>
          <div class="dropdown-content">
            <a href="#"><i class="fas fa-laptop"></i> Ordinateurs portables</a>
            <a href="#"><i class="fas fa-mobile-alt"></i> T√©l√©phones</a>
            <a href="#"><i class="fas fa-headphones"></i> Casques & √âcouteurs</a>
            <a href="#"><i class="fas fa-tablet-alt"></i> Tablettes</a>
            <a href="#"><i class="fas fa-desktop"></i> Ordinateurs de bureau</a>
            <a href="#"><i class="fas fa-keyboard"></i> P√©riph√©riques</a>
            <a href="#"><i class="fas fa-microchip"></i> Composants PC</a>
            <a href="#"><i class="fas fa-print"></i> Imprimantes</a>
            <a href="#"><i class="fas fa-gamepad"></i> Gaming</a>
            <a href="#"><i class="fas fa-tv"></i> √âcrans & Moniteurs</a>
          </div>
        </li>
        <li><a href="#">Promotions</a></li>
        <li><a href="#">√Ä propos</a></li>
        <li><a href="#">Blog</a></li>
      </ul>

      <div class="search-bar">
        <input type="text" placeholder="Rechercher un produit..." class="search-input">
      </div>

      <div class="user-actions">
        <a href="#" class="account-icon"><i class="fa-regular fa-user"></i> <span>Mon Compte</span></a>
        <a href="#" class="cart-icon"><i class="fas fa-shopping-cart"></i> <span>Panier</span> <span
            class="cart-count">3</span></a>
      </div>
    </nav>

    <!-- Overlay pour fermer le menu (utilise l'ancre) -->
    <a href="#" class="overlay" id="overlay"></a>
    </header>
    

    <div class="container">
      <aside class="sidebar">
        <div class="profile">
          <div class="avatar">PN</div>
          <div>
            <div class="name">Pierre-Marcelle N.</div>
            <div class="email">pierre@example.com</div>
          </div>
        </div>
  
        <nav class="nav">
          <a href="#profile" class="active">Account & Profil</a>
          <a href="#security">Security & Password</a>
          <a href="#commandes">My orders</a>
        </nav>
  
        <div style="margin-top:16px">
          <div class="muted">Member since</div>
          <div style="font-weight:600">12 January 2023</div>
        </div>
      </aside>
  
      <main>
        <section class="card" id="profile">
          <h1>Account parameters</h1>
          <p class="lead">G√©rez vos informations personnelles, coordonn√©es et pr√©f√©rences de compte.</p>
  
          <div class="section">
            <div class="section-title">Profil</div>
            <div class="form-grid">
              <div>
                <label>First Name</label>
                <input type="text" id= "firstName" value="Pierre" />
              </div>
              <div>
                <label>Last Name</label>
                <input type="text" id= "lastName" value="Marcelle" />
              </div>
              <div>
                <label>Email</label>
                <input type="email" id= "email" value="pierre@example.com" />
                <div class="muted">Email is used for authentification and notifications.</div>
              </div>
              <div>
                <label>Phone</label>
                <input type="text" id= "phone" value="+237 6XX XXX XXX" />
              </div>
            </div>
  
            <div class="row-right" style="margin-top:12px;">
              <button class="btn btn-primary">Save</button>
            </div>
          </div>
  
          <div class="section" id="security">
            <div class="section-title">Security</div>
            <div style="display:grid;gap:12px">
              <div>
                <label>Change password</label>
                <div class="form-grid">
                  <div><input type="password"  id="currentPassword" placeholder="Mot de passe actuel"/></div>
                  <div><input type="password" id="newPassword" placeholder="Nouveau mot de passe"/></div>
                  <div><input type="password" id="confirmPassword" placeholder="Confirmer le nouveau mot de passe"/></div>
                </div>
              </div>
  
              <div class="row-right">
                <button class="btn btn-primary">Update password</button>
              </div>
  
              <div class="muted">Conseil : utilisez un mot de passe long et unique. Activez l'authentification √† deux facteurs pour une s√©curit√© suppl√©mentaire.</div>
            </div>
          </div>
        </section>
      </main>
    </div>
  
    <script>
      const USER_LIST_KEY = "users";
      const CURRENT_EMAIL_KEY = "currentUserEmail";
      
      function loadUserData() {
        const users = JSON.parse(localStorage.getItem(USER_LIST_KEY)) || [];
        const currentEmail = localStorage.getItem(CURRENT_EMAIL_KEY);
        if (!currentEmail) return;
      
        const currentUser = users.find(u => u.email === currentEmail);
        if (!currentUser) return;
      
        const setVal = (id, val) => {
          const el = document.getElementById(id);
          if (el) el.value = val ?? "";
        };
      
        // Remplir les champs du profil
        setVal("firstName", currentUser.firstName);
        setVal("lastName", currentUser.lastName);
        setVal("email", currentUser.email);
        setVal("phone", currentUser.phone);
      
        // Mot de passe actuel (masqu√©)
        const passDisplay = document.getElementById("currentPasswordDisplay");
        if (passDisplay) passDisplay.value = currentUser.password;
      
        // Mettre √† jour les infos du panneau lat√©ral
        const nameEl = document.querySelector(".name");
        const emailEl = document.querySelector(".email");
        const avatarEl = document.querySelector(".avatar");
        if (nameEl) nameEl.textContent = `${currentUser.firstName} ${currentUser.lastName?.[0] ?? ""}.`;
        if (emailEl) emailEl.textContent = currentUser.email;
        if (avatarEl) {
          const f = (currentUser.firstName || "").charAt(0);
          const l = (currentUser.lastName || "").charAt(0);
          avatarEl.textContent = (f + l).toUpperCase();
        }
      }
      
      function saveProfile() {
        const users = JSON.parse(localStorage.getItem(USER_LIST_KEY)) || [];
        const currentEmail = localStorage.getItem(CURRENT_EMAIL_KEY);
        const index = users.findIndex(u => u.email === currentEmail);
        if (index === -1) return;
      
        const confirmed = confirm("Voulez-vous vraiment modifier vos informations ?");
        if (!confirmed) return loadUserData();
      
        users[index].firstName = document.getElementById("firstName").value;
        users[index].lastName = document.getElementById("lastName").value;
        users[index].email = document.getElementById("email").value;
        users[index].phone = document.getElementById("phone").value;
      
        localStorage.setItem(USER_LIST_KEY, JSON.stringify(users));
        localStorage.setItem(CURRENT_EMAIL_KEY, users[index].email);
      
        loadUserData();
      }
      
      function updatePassword() {
        const users = JSON.parse(localStorage.getItem(USER_LIST_KEY)) || [];
        const currentEmail = localStorage.getItem(CURRENT_EMAIL_KEY);
        const index = users.findIndex(u => u.email === currentEmail);
        if (index === -1) return;
      
        const newPass = document.getElementById("newPassword").value;
        const confirmPass = document.getElementById("confirmPassword").value;
      
        if (newPass !== confirmPass) {
          alert("Les deux mots de passe ne correspondent pas !");
          return clearPasswordFields();
        }
      
        const confirmed = confirm("Voulez-vous vraiment changer votre mot de passe ?");
        if (!confirmed) return clearPasswordFields();
      
        users[index].password = newPass;
        localStorage.setItem(USER_LIST_KEY, JSON.stringify(users));
        clearPasswordFields();
        loadUserData();
      }
      
      function clearPasswordFields() {
        document.getElementById("newPassword").value = "";
        document.getElementById("confirmPassword").value = "";
      }
      
      // üëÅÔ∏è Afficher / masquer le mot de passe actuel
      document.addEventListener("DOMContentLoaded", () => {
        const toggle = document.getElementById("togglePasswordView");
        const passField = document.getElementById("currentPasswordDisplay");
      
        if (toggle && passField) {
          toggle.addEventListener("click", () => {
            const isHidden = passField.type === "password";
            passField.type = isHidden ? "text" : "password";
            toggle.classList.toggle("fa-eye");
            toggle.classList.toggle("fa-eye-slash");
          });
        }
      
        loadUserData();
      });
    </script>
     <script src="/account.js" defer></script>
</body>
</html>